#!/bin/zsh

source ~/.zsh/alias.sh
source ~/.zsh/env.sh

# Prompt
autoload -U colors
colors
setopt prompt_subst
source ~/.zsh/hostname_color.sh
PROMPT='%(?.%F{$hostname_color}^_^%f.%F{red}x_x%f) (%1/) '

# Visual suggestions
source ~/.zsh/zsh-autosuggestions/zsh-autosuggestions.zsh

# gcd command

source ~/.zsh/gcd.sh

# History
HISTSIZE=50000
SAVEHIST=50000
HISTFILE=~/._zsh_history
setopt inc_append_history share_history

# This autoload is required on macOS for completion (For some reason)
autoload -U compinit && compinit
source ~/.zsh/tmux_complete.zsh

# Vim key bindings

bindkey -v
export KEYTIMEOUT=50

bindkey -M viins 'jj' vi-cmd-mode

function zle-line-init zle-keymap-select {
  VIM_PROMPT="[% NORMAL]%"
  RPS1="${${KEYMAP/vicmd/$VIM_PROMPT}/(main|viins)/}"
  zle reset-prompt
}

zle -N zle-line-init
zle -N zle-keymap-select

# Load config specific to this device
__local_file="$HOME/.zshrc-local" 
if [ -e $__local_file ]; then
  source $__local_file
fi
